Training started at: 2025-05-26 16:49:00
Results will be saved to: ..\model_results
================================================================================

=== Creating Protein Dataset ===
Processing protein features and encoding labels...

=== Starting Data Preparation Process ===
Starting data splitting process...
Data splitting complete
Generating negative control sets...
Found 198 families with superfamily assignments
=== Data Preparation Complete ===


=== Starting Model Training ===
--------------------------------------------------
Epoch [1/200] - Time: 1.30s
Train Loss: 7.3014, Train Acc: 0.79%
Val Loss: 6.6423, Val Acc: 16.02%
--------------------------------------------------
New best model found at epoch 1 with validation accuracy: 16.02%
Epoch [2/200] - Time: 0.98s
Train Loss: 6.7697, Train Acc: 7.69%
Val Loss: 6.1582, Val Acc: 43.75%
--------------------------------------------------
New best model found at epoch 2 with validation accuracy: 43.75%
Epoch [3/200] - Time: 1.00s
Train Loss: 6.2171, Train Acc: 22.91%
Val Loss: 5.5167, Val Acc: 56.50%
--------------------------------------------------
New best model found at epoch 3 with validation accuracy: 56.50%
Epoch [4/200] - Time: 0.99s
Train Loss: 5.5708, Train Acc: 37.63%
Val Loss: 4.6928, Val Acc: 64.77%
--------------------------------------------------
New best model found at epoch 4 with validation accuracy: 64.77%
Epoch [5/200] - Time: 0.97s
Train Loss: 4.8489, Train Acc: 48.23%
Val Loss: 3.9951, Val Acc: 67.46%
--------------------------------------------------
New best model found at epoch 5 with validation accuracy: 67.46%
Epoch [6/200] - Time: 1.00s
Train Loss: 4.1897, Train Acc: 56.92%
Val Loss: 3.2119, Val Acc: 70.08%
--------------------------------------------------
New best model found at epoch 6 with validation accuracy: 70.08%
Epoch [7/200] - Time: 0.97s
Train Loss: 3.5385, Train Acc: 64.09%
Val Loss: 2.5140, Val Acc: 72.65%
--------------------------------------------------
New best model found at epoch 7 with validation accuracy: 72.65%
Epoch [8/200] - Time: 1.02s
Train Loss: 2.9972, Train Acc: 68.00%
Val Loss: 2.0114, Val Acc: 74.95%
--------------------------------------------------
New best model found at epoch 8 with validation accuracy: 74.95%
Epoch [9/200] - Time: 1.01s
Train Loss: 2.5585, Train Acc: 70.53%
Val Loss: 1.6037, Val Acc: 75.40%
--------------------------------------------------
New best model found at epoch 9 with validation accuracy: 75.40%
Epoch [10/200] - Time: 1.00s
Train Loss: 2.1698, Train Acc: 72.15%
Val Loss: 1.3294, Val Acc: 77.19%
--------------------------------------------------
New best model found at epoch 10 with validation accuracy: 77.19%
Epoch [11/200] - Time: 1.00s
Train Loss: 1.8655, Train Acc: 74.63%
Val Loss: 1.1250, Val Acc: 77.00%
--------------------------------------------------
Epoch [12/200] - Time: 1.02s
Train Loss: 1.6550, Train Acc: 76.03%
Val Loss: 1.0360, Val Acc: 77.39%
--------------------------------------------------
New best model found at epoch 12 with validation accuracy: 77.39%
Epoch [13/200] - Time: 0.99s
Train Loss: 1.5399, Train Acc: 76.32%
Val Loss: 0.9380, Val Acc: 77.83%
--------------------------------------------------
New best model found at epoch 13 with validation accuracy: 77.83%
Epoch [14/200] - Time: 0.96s
Train Loss: 1.3532, Train Acc: 77.64%
Val Loss: 0.9310, Val Acc: 76.62%
--------------------------------------------------
Epoch [15/200] - Time: 0.90s
Train Loss: 1.2813, Train Acc: 77.40%
Val Loss: 0.9108, Val Acc: 77.26%
--------------------------------------------------
Epoch [16/200] - Time: 0.91s
Train Loss: 1.2649, Train Acc: 77.22%
Val Loss: 0.8936, Val Acc: 77.00%
--------------------------------------------------
Epoch [17/200] - Time: 0.90s
Train Loss: 1.1657, Train Acc: 79.44%
Val Loss: 0.8723, Val Acc: 77.39%
--------------------------------------------------
Epoch [18/200] - Time: 0.90s
Train Loss: 1.1596, Train Acc: 79.33%
Val Loss: 0.9061, Val Acc: 77.39%
--------------------------------------------------
Epoch [19/200] - Time: 0.88s
Train Loss: 1.1409, Train Acc: 80.15%
Val Loss: 0.9126, Val Acc: 77.58%
--------------------------------------------------
Epoch [20/200] - Time: 0.91s
Train Loss: 1.0380, Train Acc: 80.44%
Val Loss: 0.8917, Val Acc: 77.77%
--------------------------------------------------
Epoch [21/200] - Time: 0.90s
Train Loss: 0.9841, Train Acc: 81.84%
Val Loss: 0.8761, Val Acc: 78.28%
--------------------------------------------------
New best model found at epoch 21 with validation accuracy: 78.28%
Epoch [22/200] - Time: 0.91s
Train Loss: 0.9214, Train Acc: 82.29%
Val Loss: 0.8876, Val Acc: 78.92%
--------------------------------------------------
New best model found at epoch 22 with validation accuracy: 78.92%
Epoch [23/200] - Time: 0.90s
Train Loss: 0.9566, Train Acc: 81.71%
Val Loss: 0.8772, Val Acc: 78.60%
--------------------------------------------------
Epoch [24/200] - Time: 0.98s
Train Loss: 0.8995, Train Acc: 83.09%
Val Loss: 0.8827, Val Acc: 78.92%
--------------------------------------------------
Epoch [25/200] - Time: 0.98s
Train Loss: 0.9147, Train Acc: 81.95%
Val Loss: 0.8909, Val Acc: 78.54%
--------------------------------------------------
Epoch [26/200] - Time: 0.98s
Train Loss: 0.8891, Train Acc: 82.72%
Val Loss: 0.9024, Val Acc: 78.09%
--------------------------------------------------
Epoch [27/200] - Time: 1.00s
Train Loss: 0.8387, Train Acc: 83.35%
Val Loss: 0.9034, Val Acc: 78.80%
--------------------------------------------------
Epoch [28/200] - Time: 1.03s
Train Loss: 0.8402, Train Acc: 83.30%
Val Loss: 0.8946, Val Acc: 79.76%
--------------------------------------------------
New best model found at epoch 28 with validation accuracy: 79.76%
Epoch [29/200] - Time: 1.01s
Train Loss: 0.8381, Train Acc: 83.62%
Val Loss: 0.9024, Val Acc: 79.12%
--------------------------------------------------
Epoch [30/200] - Time: 1.04s
Train Loss: 0.8422, Train Acc: 83.43%
Val Loss: 0.8962, Val Acc: 78.92%
--------------------------------------------------
Epoch [31/200] - Time: 1.02s
Train Loss: 0.8341, Train Acc: 82.95%
Val Loss: 0.8937, Val Acc: 79.63%
--------------------------------------------------
Epoch [32/200] - Time: 1.00s
Train Loss: 0.8091, Train Acc: 83.30%
Val Loss: 0.9025, Val Acc: 78.80%
--------------------------------------------------
Epoch [33/200] - Time: 0.99s
Train Loss: 0.8232, Train Acc: 84.46%
Val Loss: 0.9077, Val Acc: 79.31%
--------------------------------------------------
Epoch [34/200] - Time: 0.97s
Train Loss: 0.8112, Train Acc: 83.88%
Val Loss: 0.9111, Val Acc: 78.28%
--------------------------------------------------
Epoch [35/200] - Time: 0.98s
Train Loss: 0.7917, Train Acc: 84.06%
Val Loss: 0.9017, Val Acc: 78.86%
--------------------------------------------------
Epoch [36/200] - Time: 0.99s
Train Loss: 0.7672, Train Acc: 84.43%
Val Loss: 0.8960, Val Acc: 79.44%
--------------------------------------------------
Epoch [37/200] - Time: 1.00s
Train Loss: 0.7396, Train Acc: 84.99%
Val Loss: 0.8989, Val Acc: 79.69%
--------------------------------------------------
Epoch [38/200] - Time: 0.98s
Train Loss: 0.7482, Train Acc: 85.44%
Val Loss: 0.8939, Val Acc: 80.08%
--------------------------------------------------
New best model found at epoch 38 with validation accuracy: 80.08%
Epoch [39/200] - Time: 1.01s
Train Loss: 0.7448, Train Acc: 85.31%
Val Loss: 0.9022, Val Acc: 79.95%
--------------------------------------------------
Epoch [40/200] - Time: 1.00s
Train Loss: 0.7500, Train Acc: 84.54%
Val Loss: 0.8988, Val Acc: 80.08%
--------------------------------------------------
Epoch [41/200] - Time: 1.00s
Train Loss: 0.7322, Train Acc: 85.33%
Val Loss: 0.9060, Val Acc: 79.56%
--------------------------------------------------
Epoch [42/200] - Time: 1.04s
Train Loss: 0.6999, Train Acc: 85.81%
Val Loss: 0.9116, Val Acc: 79.05%
--------------------------------------------------
Epoch [43/200] - Time: 1.01s
Train Loss: 0.7381, Train Acc: 85.73%
Val Loss: 0.9114, Val Acc: 79.44%
--------------------------------------------------
Epoch [44/200] - Time: 0.99s
Train Loss: 0.7430, Train Acc: 85.31%
Val Loss: 0.9265, Val Acc: 79.76%
--------------------------------------------------
Epoch [45/200] - Time: 0.96s
Train Loss: 0.6999, Train Acc: 85.62%
Val Loss: 0.9247, Val Acc: 80.14%
--------------------------------------------------
New best model found at epoch 45 with validation accuracy: 80.14%
Epoch [46/200] - Time: 0.98s
Train Loss: 0.6936, Train Acc: 86.73%
Val Loss: 0.9225, Val Acc: 80.20%
--------------------------------------------------
New best model found at epoch 46 with validation accuracy: 80.20%
Epoch [47/200] - Time: 0.99s
Train Loss: 0.6919, Train Acc: 86.50%
Val Loss: 0.9173, Val Acc: 80.14%
--------------------------------------------------
Epoch [48/200] - Time: 0.98s
Train Loss: 0.6730, Train Acc: 85.68%
Val Loss: 0.9170, Val Acc: 79.69%
--------------------------------------------------
Epoch [49/200] - Time: 0.91s
Train Loss: 0.6914, Train Acc: 86.15%
Val Loss: 0.9265, Val Acc: 79.37%
--------------------------------------------------
Epoch [50/200] - Time: 0.92s
Train Loss: 0.6726, Train Acc: 86.68%
Val Loss: 0.9260, Val Acc: 79.76%
--------------------------------------------------
Epoch [51/200] - Time: 0.91s
Train Loss: 0.6607, Train Acc: 86.63%
Val Loss: 0.9256, Val Acc: 79.88%
--------------------------------------------------
Epoch [52/200] - Time: 0.97s
Train Loss: 0.6747, Train Acc: 86.34%
Val Loss: 0.9217, Val Acc: 79.76%
--------------------------------------------------
Epoch [53/200] - Time: 0.98s
Train Loss: 0.6787, Train Acc: 86.42%
Val Loss: 0.9276, Val Acc: 80.01%
--------------------------------------------------
Epoch [54/200] - Time: 0.99s
Train Loss: 0.6542, Train Acc: 87.37%
Val Loss: 0.9252, Val Acc: 80.33%
--------------------------------------------------
New best model found at epoch 54 with validation accuracy: 80.33%
Epoch [55/200] - Time: 0.94s
Train Loss: 0.6857, Train Acc: 86.05%
Val Loss: 0.9302, Val Acc: 80.27%
--------------------------------------------------
Epoch [56/200] - Time: 0.90s
Train Loss: 0.6646, Train Acc: 86.73%
Val Loss: 0.9199, Val Acc: 80.20%
--------------------------------------------------
Epoch [57/200] - Time: 0.92s
Train Loss: 0.6739, Train Acc: 86.68%
Val Loss: 0.9282, Val Acc: 80.08%
--------------------------------------------------
Epoch [58/200] - Time: 0.97s
Train Loss: 0.6552, Train Acc: 86.76%
Val Loss: 0.9250, Val Acc: 80.27%
--------------------------------------------------
Epoch [59/200] - Time: 0.98s
Train Loss: 0.6664, Train Acc: 86.50%
Val Loss: 0.9249, Val Acc: 80.40%
--------------------------------------------------
New best model found at epoch 59 with validation accuracy: 80.40%
Epoch [60/200] - Time: 0.99s
Train Loss: 0.6697, Train Acc: 87.79%
Val Loss: 0.9269, Val Acc: 80.14%
--------------------------------------------------
Epoch [61/200] - Time: 1.00s
Train Loss: 0.6747, Train Acc: 86.95%
Val Loss: 0.9255, Val Acc: 80.85%
--------------------------------------------------
New best model found at epoch 61 with validation accuracy: 80.85%
Epoch [62/200] - Time: 1.00s
Train Loss: 0.6494, Train Acc: 86.68%
Val Loss: 0.9251, Val Acc: 80.33%
--------------------------------------------------
Epoch [63/200] - Time: 1.00s
Train Loss: 0.6764, Train Acc: 86.55%
Val Loss: 0.9274, Val Acc: 80.27%
--------------------------------------------------
Epoch [64/200] - Time: 1.00s
Train Loss: 0.6680, Train Acc: 87.26%
Val Loss: 0.9216, Val Acc: 80.27%
--------------------------------------------------
Epoch [65/200] - Time: 0.98s
Train Loss: 0.6521, Train Acc: 87.24%
Val Loss: 0.9242, Val Acc: 80.08%
--------------------------------------------------
Epoch [66/200] - Time: 0.97s
Train Loss: 0.6539, Train Acc: 86.76%
Val Loss: 0.9257, Val Acc: 80.08%
--------------------------------------------------
Epoch [67/200] - Time: 0.97s
Train Loss: 0.6612, Train Acc: 87.00%
Val Loss: 0.9297, Val Acc: 79.82%
--------------------------------------------------
Epoch [68/200] - Time: 0.99s
Train Loss: 0.6430, Train Acc: 87.37%
Val Loss: 0.9245, Val Acc: 80.08%
--------------------------------------------------
Epoch [69/200] - Time: 0.99s
Train Loss: 0.6510, Train Acc: 87.24%
Val Loss: 0.9309, Val Acc: 80.20%
--------------------------------------------------
Epoch [70/200] - Time: 0.97s
Train Loss: 0.6477, Train Acc: 86.73%
Val Loss: 0.9303, Val Acc: 79.69%
--------------------------------------------------
Epoch [71/200] - Time: 0.98s
Train Loss: 0.6468, Train Acc: 86.97%
Val Loss: 0.9276, Val Acc: 79.88%
--------------------------------------------------
Epoch [72/200] - Time: 0.98s
Train Loss: 0.6652, Train Acc: 87.02%
Val Loss: 0.9275, Val Acc: 79.69%
--------------------------------------------------
Epoch [73/200] - Time: 0.90s
Train Loss: 0.6488, Train Acc: 86.68%
Val Loss: 0.9244, Val Acc: 79.95%
--------------------------------------------------
Epoch [74/200] - Time: 0.89s
Train Loss: 0.6494, Train Acc: 87.02%
Val Loss: 0.9296, Val Acc: 79.95%
--------------------------------------------------
Epoch [75/200] - Time: 0.98s
Train Loss: 0.6619, Train Acc: 86.76%
Val Loss: 0.9219, Val Acc: 80.14%
--------------------------------------------------
Epoch [76/200] - Time: 1.00s
Train Loss: 0.6563, Train Acc: 87.50%
Val Loss: 0.9278, Val Acc: 80.27%
--------------------------------------------------
Early stopping triggered after 76 epochs
Total training time: 74.30s
Training history plot saved as '..\model_results\training_history.png'

Using best model from epoch 61 with validation accuracy: 80.85%
Model saved to ..\model_results\best_protein_classifier.pth

Performing detailed evaluation...

=== Detailed Subfamily Classification Report ===